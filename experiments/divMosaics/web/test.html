<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Tween Obj Experiment</title>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>

        <link rel="stylesheet" href="css/style.css" type="text/css"/>

        <script src="js/tween/tween.js"></script>

        
    </head>
    <body>
        <div id="demo"></div>


        <script>
        /*
            80x74 is an example size of one of the images when resolution is 10
            This means there are 5920 divs, and 5920 objects which Tween JS is animation.

            The aim of this code is to investigate whether the slowdown from Tween JS animating
            5920 objects is a signficant part of the performance issues in the main divMosaics demo.
        */
        requestAnimationFrame(animate);

        window.addEventListener('click', function() {
            var n = 5920; // 80 * 74 = 5920
            var cw = document.body.clientWidth,
                ch = document.body.clientHeight;
            console.time('tween');
            _.times(n, (i) => {
                var obj = {
                    x: 0,
                    y: 0
                };

                var dx = _.random(0, cw),
                    dy = _.random(0, ch);
                new TWEEN.Tween(obj).to({x: dx, y: dy}, 1000).easing(TWEEN.Easing.Sinusoidal.InOut).onComplete(_.partial(tweenComplete, i + 1)).start();
            });

            function tweenComplete(i) {
                if (i === n) {
                    console.timeEnd('tween');
                }
            }

        });

        function animate(t) {
            requestAnimationFrame(animate);
            TWEEN.update(t);
        }
        </script>
    </body>
</html>
